<style>
/* ===== TABS ===== */
.top-buttons {
  display: flex;
  justify-content: center;
  gap: 10px;
  padding: 10px;
  flex-wrap: wrap;
}

.top-buttons button {
  border: 2px solid orange;
  border-radius: 25px;
  background: transparent;
  color: orange;
  font-weight: bold;
  height: 40px;
  width: 20%;
  font-size: 14px;
  cursor: pointer;
  margin: 5px;
  transition: 0.3s;
}

.top-buttons button.active {
  background: orange;
  color: #3d2b1f;
  border: none;
}

/* ===== MOBILE ===== */
@media (max-width: 650px) {
  .top-buttons {
    display: block;
  }
  .top-buttons button {
    width: 100%;
    margin: 12px 0;
  }
  .stats {
    margin-top: 20px;
  }
  .footer-time {
    margin-top: 20px;
  }
}

/* ===== COMMON ===== */
.section { display: none; }
.section.active { display: block; }

.container { padding: 20px; }

.score-title {
  font-size: 20px;
}

.username {
  font-size: 24px;
  font-weight: bold;
  color: white;
  margin-top: 10px;
}

.stats {
  display: flex;
  justify-content: space-around;
  flex-wrap: wrap;
}

.stat-box {
  color: orange;
  font-size: 24px;
  margin: 10px;
}

.stat-box span {
  display: block;
  font-size: 22px;
  color: white;
  margin-top: 10px;
}

.footer-time {
  color: orange;
  font-size: 24px;
}

.footer-time span {
  display: block;
  color: white;
  font-size: 22px;
  margin-top: 10px;
}

#user_rank {
  color: orange;
  font-size: 24px;
  margin: 5px 0;
}

/* ===== TABLE ===== */
#winner-table {
  width: 100%;
  border-collapse: collapse;
}

#winner-table th,
#winner-table td {
  padding: 10px;
  border: 1px solid rgba(255,255,255,0.3);
  text-align: center;
}

#winner-table th {
  background: rgba(255,255,255,0.08);
}
</style>
<script>
<%
function formatTime(timeStr) {
  if (!timeStr) return "-";

  const parts = timeStr.split(":");
  let h = parts[0];
  let m = parts[1];
  let s = parts[2];

  let result = [];

  if (h && h !== "00h") result.push(h);
  if (m && m !== "00m") result.push(m);
  if (s) result.push(s);

  return result.join(":");
}
%>

</script>


<!-- TABS -->
<div class="top-buttons">
  <button class="tab-btn active" onclick="showSection('myScores', this)">My Scores</button>
  <button class="tab-btn" onclick="showSection('questionsPlayed', this)">Questions Played</button>
  <button class="tab-btn" onclick="showSection('gamesPlayed', this)">Games Played</button>
  <button class="tab-btn" onclick="showSection('timePlayed', this)">Time Played</button>
</div>

<script>
function showSection(id, btn) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  btn.classList.add('active');
}
</script>

<!-- MY SCORES -->
<div id="myScores" class="section active">
  <div class="container">
    <div class="score-title">Your Score for <%= questionType %> Game</div>
    <div class="username"><%= fullname || username %></div>

    <div class="stats">
      <div class="stat-box">Total Games <span><%= game_score %></span></div>
      <div class="stat-box">Total Questions <span><%= question_score %></span></div>
    </div>

    <div class="footer-time">
      Total Time
      <span><%= time_score ? formatTime(time_score) : '-' %></span>
    </div>
  </div>
</div>

<!-- QUESTIONS -->
<div id="questionsPlayed" class="section">
  <p id="user_rank">Your Rank is : <%= userQuestionRank %></p>
  <table id="winner-table">
    <thead>
      <tr>
        <th>üèÖ Rank</th>
        <th> <i class="fa-solid fa-user"></i> Username</th>
        <th>üöÄ Score</th>
      </tr>
    </thead>
    <tbody>
      <% question_played.forEach(s => { %>
      <tr>
        <td>#<%= s.rank %></td>
        <td><%= s.fullname || s.username %></td>
        <td><%= s.question_score %></td>
      </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<!-- GAMES -->
<div id="gamesPlayed" class="section">
  <p id="user_rank">Your Rank is : <%= userGameRank %></p>
  <table id="winner-table">
    <thead>
      <tr>
        <th>üèÖ Rank</th>
        <th> <i class="fa-solid fa-user"></i> Username</th>
        <th> üöÄ Game</th>
      </tr>
    </thead>
    <tbody>
      <% game_played.forEach(s => { %>
      <tr>
        <td>#<%= s.rank %></td>
        <td><%= s.fullname || s.username %></td>
        <td><%= s.game_played %></td>
      </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<!-- TIME -->
<div id="timePlayed" class="section">
  <p id="user_rank">Your Rank is : <%= userTimeRank %></p>
  <table id="winner-table">
    <thead>
      <tr>
        <th>üèÖ Rank</th>
        <th> <i class="fa-solid fa-user"></i> Username</th>
        <th>‚è∞ Play Time</th>
      </tr>
    </thead>
    <tbody>
      <% time_played.forEach(s => { %>
      <tr>
        <td>#<%= s.rank %></td>
        <td><%= s.fullname || s.username %></td>
        <td><%= s.total_play_time ? formatTime(s.total_play_time) : '-' %></td>
      </tr>
      <% }) %>
    </tbody>
  </table>
</div>
